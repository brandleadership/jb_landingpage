<div data-bsi-element="chart">
    <canvas id="canvas"></canvas>

    {# Example with fetch json #} 
    <script id="data" type="application/json">
        {
            "data": [
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2020,
                    "Year": "2020",
                    "Population": 326569308,
                    "Slug Nation": "united-states"
                },
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2019,
                    "Year": "2019",
                    "Population": 324697795,
                    "Slug Nation": "united-states"
                },
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2018,
                    "Year": "2018",
                    "Population": 322903030,
                    "Slug Nation": "united-states"
                },
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2017,
                    "Year": "2017",
                    "Population": 321004407,
                    "Slug Nation": "united-states"
                },
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2016,
                    "Year": "2016",
                    "Population": 318558162,
                    "Slug Nation": "united-states"
                },
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2015,
                    "Year": "2015",
                    "Population": 316515021,
                    "Slug Nation": "united-states"
                },
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2014,
                    "Year": "2014",
                    "Population": 314107084,
                    "Slug Nation": "united-states"
                },
                {
                    "ID Nation": "01000US",
                    "Nation": "United States",
                    "ID Year": 2013,
                    "Year": "2013",
                    "Population": 311536594,
                    "Slug Nation": "united-states"
                }
            ],
        "bgcolors": [
                { "color": "#001489"},
                { "color": "#1A2C95"},
                { "color": "#3343A1"},
                { "color": "#4D5BA"},
                { "color": "#6672B8"},
                { "color": "#808AC4"},
                { "color": "#99A1D0"},
                { "color": "#B3B9DC"}
            ]
        }
    </script>

    {# Example with fetching JSON  #}
    <script>
        getData();

        async function getData() {
            const data = await JSON.parse(document.getElementById('data').textContent);

            console.log(data);
            length = data.data.length;
            console.log(length);


            // Get data for the dataset (in this case Year and Population)
            labels = [];
            values = [];
            for (i = 0; i < length; i++) {
                labels.push(data.data[i].Year);
                values.push(data.data[i].Population);
            }
            
            // Get background colors for the config
            backgroundcolors = [];
            colorlength = data.bgcolors.length;
            for (i = 0; i < colorlength; i++) {
                backgroundcolors.push(data.bgcolors[i].color);
            }
            console.log(backgroundcolors);
            

            // Define chart type
            values.type = "bar"


            // TO DO: Extract the whole config space into the JSON 

            new Chart(document.getElementById("canvas"), {
                type: values.type,
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: "Population (millions)",
                            backgroundColor: backgroundcolors,
                            data: values,
                        },
                    ],
                },
                options: {
                    legend: { display: false },
                    title: {
                        display: true,
                        text: "U.S population",
                    },
                },
            });
        }
    </script>
</div>